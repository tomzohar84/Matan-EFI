


<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8" />
    <title>Pro 32r </title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
     /* סגנונות כלליים לדף */
body {
    font-family: Arial, sans-serif; /* הגדרת גופן ברירת מחדל */
    background: #fff; /* צבע רקע לבן */
    margin: 0; /* הסרת שוליים חיצוניים */
    padding: 0; /* הסרת ריווח פנימי */
}

h1 {
    text-align: center; /* מיקום הכותרת במרכז */
    color: #176c4c; /* צבע ירוק כהה לכותרת */
    margin: 18px 0 10px 0; /* שוליים חיצוניים סביב הכותרת */
    font-size: 1em; /* גודל גופן קטן יחסית */
    letter-spacing: 1px; /* ריווח בין אותיות */
}

/* סגנונות לטבלה ולמסגרת סביבה */
.box-table-wrapper {
    position: relative; /* מיקום יחסי כדי לאפשר מיקום מוחלט של כפתורים בתוכו */
    width: 900px; /* רוחב מוגדל לטבלה במסכים גדולים */
    max-width: 98vw; /* רוחב מקסימלי למניעת גלישה במסכים קטנים */
    margin: 18px auto 0 auto; /* מיקום במרכז הדף עם שוליים עליונים */
    page-break-inside: avoid; /* מניעת שבירת טבלה בהדפסה */
}

.box-table {
    width: 100%; /* רוחב מלא של המסגרת */
    border-collapse: collapse; /* איחוד גבולות התאים */
    background: #fff; /* רקע לבן לטבלה */
    box-shadow: 0 2px 8px rgba(0,0,0,0.04); /* צל קל סביב הטבלה לעומק */
    font-size: 0.93em; /* גודל גופן קטן יחסית */
}

/* הפיכת כל הכתב בדף למודגש */
body, body * {
    font-weight: bold !important;
	text-transform: uppercase !important;

}


.box-table th, .box-table td {
    border: 1px solid #176c4c; /* גבול ירוק כהה סביב כל תא */
    padding: 8px; /* ריווח פנימי בתוך התאים */
    text-align: center; /* מיקום טקסט במרכז התא */
    color: #176c4c; /* צבע טקסט ירוק כהה */
    overflow: visible; /* מניעת חיתוך טקסט */
    text-overflow: unset; /* מניעת קיצור טקסט */
    white-space: normal; /* אפשרות לשבירת שורות */
    word-wrap: break-word; /* שבירת מילים ארוכות */
}

.box-table th {
    background: #e6f2ef; /* רקע ירוק בהיר לכותרות */
    font-weight: bold; /* טקסט מודגש */
}

.box-table th.box-header {
    background: #e6f2ef; /* רקע ירוק בהיר לתא BOX */
    color: #176c4c; /* צבע טקסט ירוק כהה */
    width: 7%; /* רוחב מוקטן לתא BOX */
    padding: 0; /* ללא ריווח פנימי */
    white-space: normal; /* אפשרות לשבירת שורות */
    line-height: 1.2; /* גובה שורה קטן למראה צפוף */
}

/* סגנונות לתאים ספציפיים בטבלה */
.row-num-cell {
    width: 5%; /* רוחב מוקטן מאוד לתא מספר שורה */
    font-weight: bold; /* טקסט מודגש */
    color: #176c4c; /* צבע ירוק כהה */
    text-align: center; /* מיקום טקסט במרכז */
    background: #fff; /* ללא צבע רקע */
    border: 1px solid #176c4c; /* מסגרת ירוקה תואמת */
}

.desc-col {
    text-align: left; /* מיקום טקסט בצד שמאל לתיאור */
    font-weight: bold; /* טקסט מודגש */
    color: #176c4c; /* צבע ירוק כהה */
    width: 73%; /* רוחב מוגדל מאוד לתא תיאור כדי שיהיה דומיננטי */
    white-space: normal; /* אפשרות לשבירת שורות */
    word-break: break-all; /* שבירת מילים ארוכות */
    font-size: 1.1em; /* גודל גופן מעט גדול יותר לקריאות */
}

.pn-col {
    width: 10%; /* רוחב מוקטן מאוד לתא מק"ט */
    font-weight: bold; /* טקסט מודגש */
}

.qty-col {
    width: 15%; /* רוחב מוקטן מאוד לתא כמות */
    font-weight: bold; /* טקסט מודגש */
}

.check-col {
    width: 5%; /* רוחב מוקטן מאוד לתא צ'קבוקס */
    font-weight: bold; /* טקסט מודגש */
}

.action-col {
    width: 5%; /* רוחב מוקטן מאוד לתא פעולות (הסרה/שחזור) */
}

/* סגנונות לצ'קבוקס */
input[type="checkbox"] {
    width: 16px; /* רוחב הצ'קבוקס */
    height: 16px; /* גובה הצ'קבוקס */
    cursor: pointer; /* סמן עכבר בצורת יד ללחיצה */
}

/* סגנונות לשדות קלט (תיבות טקסט) בשורות חדשות */
input[type="text"], input[type="number"] {
    border: none; /* הסרת מסגרת סביב שדות הקלט */
    background: transparent; /* רקע שקוף כדי שלא ייראה כמו ריבוע */
    width: 100%; /* רוחב מלא של התא */
    height: 100%; /* גובה מלא של התא */
    padding: 0; /* הסרת ריווח פנימי */
    margin: 0; /* הסרת שוליים */
    outline: none; /* הסרת מסגרת פוקוס בעת לחיצה */
    text-align: inherit; /* ירושת מיקום טקסט מהתא (שמאל לתיאור, מרכז לאחרים) */
    color: #176c4c; /* צבע טקסט ירוק כהה, תואם לטבלה */
    font-size: 1em; /* גודל גופן תואם לטבלה */
    font-family: Arial, sans-serif; /* גופן תואם לטבלה */
}

/* סגנונות לתפריט נפתח (select) */
select {
    border: none; /* הסרת מסגרת סביב התפריט הנפתח */
    background: transparent; /* רקע שקוף */
    width: 100%; /* רוחב מלא של התא */
    padding: 0; /* הסרת ריווח פנימי */
    margin: 0; /* הסרת שוליים */
    outline: none; /* הסרת מסגרת פוקוס */
    color: #176c4c; /* צבע טקסט ירוק כהה */
    font-size: 1em; /* גודל גופן תואם לטבלה */
    cursor: pointer; /* סמן עכבר בצורת יד */
}

/* סגנונות לכפתורים בצד הימני של הטבלה */
.icon-btn {
    position: absolute; /* מיקום מוחלט ביחס למסגרת הטבלה */
    right: -35px; /* מרחיק את הכפתורים מהטבלה כדי למנוע חפיפה */
    background: none; /* ללא רקע */
    border: none; /* ללא מסגרת */
    cursor: pointer; /* סמן עכבר בצורת יד */
    z-index: 10; /* שכבה עליונה כדי שיהיה מעל אלמנטים אחרים */
    padding: 0; /* ללא ריווח פנימי */
    margin-bottom: 10px; /* מרווח אנכי בין כפתורים */
}

.icon-btn img {
    width: 24px; /* גודל אייקון מוגדל לבהירות */
    height: 24px; /* גודל אייקון מוגדל */
    display: block; /* תצוגה כבלוק */
}

.trashBtn {
    top: 0px; /* כפתור הפח בראש, קרוב לשורת הכותרת */
}

.undoBtn {
    top: 0px; /* כפתור השחזור של הטבלה באותו מקום כמו הפח (מופיע רק כשהפח מוסתר) */
}

.addRowBtn {
    top: 34px; /* כפתור הוספת שורה מתחת לפח, עם מרווח אנכי ברור */
}

.cloneBtn {
    top: 74px; /* כפתור שכפול מתחת לכפתור הוספת שורה, עם מרווח אנכי גדול יותר */
}

/* סגנונות למצב מוסתר (טבלה או שורה) */
.dimmed {
    opacity: 0.34; /* שקיפות לטבלה מוסתרת */
    pointer-events: none; /* מניעת לחיצה */
    filter: grayscale(0.7) blur(1px); /* אפקט אפור וטשטוש */
    user-select: none; /* מניעת בחירת טקסט */
}

.dimmed * {
    pointer-events: none !important; /* מניעת לחיצה על כל האלמנטים בתוך הטבלה המוסתרת */
    user-select: none !important; /* מניעת בחירת טקסט */
}

.box-table-wrapper.dimmed .undoBtn {
    pointer-events: auto !important; /* אפשרות ללחוץ על כפתור השחזור בטבלה מוסתרת */
    filter: none !important; /* הסרת טשטוש */
    opacity: 1 !important; /* שקיפות מלאה */
}

/* סגנונות לחלון הכפתורים הצף */
.floating-window {
    position: fixed; /* מיקום קבוע בצד שמאל למעלה */
    top: 10px; /* מרחק מהחלק העליון */
    left: 10px; /* מרחק מהצד השמאלי */
    background: #fff; /* רקע לבן */
    border: 2px solid #23b6d8; /* מסגרת כחולה */
    border-radius: 16px; /* פינות מעוגלות */
    box-shadow: 0 4px 18px rgba(0,0,0,0.10); /* צל סביב החלון */
    z-index: 2000; /* שכבה עליונה מאוד */
    display: flex; /* תצוגת פלקס לעריכה אנכית */
    flex-direction: column; /* כיוון אנכי */
    gap: 12px; /* מרווח בין כפתורים */
    align-items: center; /* מיקום במרכז */
    padding: 12px 10px; /* ריווח פנימי */
    user-select: none; /* מניעת בחירת טקסט */
}

.floating-window button {
    background: none; /* ללא רקע */
    border: none; /* ללא מסגרת */
    padding: 0; /* ללא ריווח פנימי */
    cursor: pointer; /* סמן עכבר בצורת יד */
    transition: transform 0.13s; /* אנימציה קלה בעת ריחוף */
    outline: none; /* הסרת מסגרת פוקוס */
}

.floating-window button:focus,
.floating-window button:hover {
    transform: scale(1.08); /* הגדלה קלה בעת ריחוף או פוקוס */
}

.floating-window img {
    width: 32px; /* גודל אייקון */
    height: 32px; /* גודל אייקון */
    border-radius: 50%; /* צורה עגולה */
    background: #fff; /* רקע לבן */
    border: 2px solid #ff9900; /* מסגרת כתומה */
    box-shadow: 0 2px 8px rgba(0,0,0,0.10); /* צל קל */
}

.floating-window .add-btn {
    width: 34px; /* גודל כפתור הוספה */
    height: 34px; /* גודל כפתור הוספה */
    border-radius: 50%; /* צורה עגולה */
    background: #23b6d8; /* רקע כחול */
    color: #fff; /* צבע טקסט לבן */
    font-size: 2em; /* גודל גופן גדול */
    line-height: 0.8; /* גובה שורה */
    box-shadow: 0 2px 8px rgba(0,0,0,0.10); /* צל קל */
    display: flex; /* תצוגת פלקס למיקום */
    align-items: center; /* מיקום אנכי במרכז */
    justify-content: center; /* מיקום אופקי במרכז */
}

.floating-window .add-btn:hover {
    background: #176c4c; /* שינוי צבע לירוק כהה בעת ריחוף */
}

/* סגנונות לשורות מוסתרות */
.row-dimmed td, .row-dimmed input, .row-dimmed select {
    color: #aaa !important; /* צבע אפור לטקסט בשורות מוסתרות */
    background: #f5f5f5 !important; /* רקע אפור בהיר */
}

.row-dimmed input, .row-dimmed select {
    pointer-events: none; /* מניעת לחיצה על צ'קבוקס או תפריט נפתח בשורות מוסתרות */
}

.row-dimmed .del-row-btn {
    display: none; /* הסתרת כפתור הסרה בשורות מוסתרות */
}

.row-dimmed .undo-row-btn {
    display: inline; /* הצגת כפתור שחזור בשורות מוסתרות */
}

.undo-row-btn {
    display: none; /* כפתור שחזור מוסתר כברירת מחדל */
}
/* סגנונות לתיבת בחירה בעמודה Qty */
.qty-col select {
    text-align: center; /* מרכוז הטקסט בתיבת הבחירה */
    text-align-last: center; /* מרכוז הטקסט הנבחר בדפדפנים כמו Chrome */
    -ms-text-align-last: center; /* תמיכה ב-Edge ו-IE */
    -moz-text-align-last: center; /* תמיכה ב-Firefox */
    width: 100%; /* ודא שהתיבה תופסת את כל רוחב התא */
    border: none; /* הסרת מסגרת */
    background: transparent; /* רקע שקוף */
    padding: 0; /* הסרת ריווח פנימי */
    margin: 0; /* הסרת שוליים */
    outline: none; /* הסרת מסגרת פוקוס */
    color: #176c4c; /* צבע טקסט ירוק כהה */
    font-size: 1em; /* גודל גופן תואם לטבלה */
    cursor: pointer; /* סמן עכבר בצורת יד */
}
/* מרכוז אפשרויות בתוך תיבת הבחירה (עבור דפדפנים שתומכים) */
.qty-col select option {
    text-align: center; /* ניסיון למרכז את האפשרויות עצמן, אם הדפדפן תומך */
}


/* סגנונות לכפתורי פעולה בתוך הטבלה */
.del-row-btn, .undo-row-btn {
    background: none; /* ללא רקע */
    border: none; /* ללא מסגרת */
    cursor: pointer; /* סמן עכבר בצורת יד */
    color: #176c4c; /* צבע ירוק כהה */
    font-size: 1em; /* גודל גופן רגיל */
}

/* סגנונות לאזור הערות בסוף הדף */
.notes-section {
    width: 876px; /* רוחב תואם לטבלאות */
    max-width: 98vw; /* רוחב מקסימלי למניעת גלישה */
    margin: 20px auto; /* מיקום במרכז הדף עם שוליים עליונים */
    padding: 10px; /* ריווח פנימי */
    background: #fff; /* רקע לבן */
    border: 1px solid #176c4c; /* מסגרת ירוקה תואמת לטבלאות */
    border-radius: 5px; /* פינות מעוגלות קלות */
    box-shadow: 0 2px 8px rgba(0,0,0,0.04); /* צל קל לעומק, תואם לטבלאות */
}

.notes-section h2 {
    color: #176c4c; /* צבע ירוק כהה לכותרת, תואם לטבלאות */
    font-size: 1.2em; /* גודל גופן מעט גדול */
    margin: 0 0 10px 0; /* שוליים תחתונים */
    text-align: center; /* מיקום במרכז */
    background: #e6f2ef; /* רקע ירוק בהיר, תואם לכותרות הטבלאות */
    padding: 5px; /* ריווח פנימי */
    border-radius: 3px; /* פינות מעוגלות קלות */
}

#notes-area {
    width: 100%; /* רוחב מלא של האזור */
    border: 1px solid #176c4c; /* מסגרת ירוקה דקה, תואמת לטבלאות */
    border-radius: 5px; /* פינות מעוגלות */
    padding: 10px; /* ריווח פנימי */
    font-family: Arial, sans-serif; /* גופן תואם לטבלה */
    font-size: 1em; /* גודל גופן רגיל */
    color: #176c4c; /* צבע טקסט ירוק כהה, תואם לטבלאות */
    resize: vertical; /* אפשרות לשנות גובה בלבד */
    box-sizing: border-box; /* כולל את המסגרת והריווח בחישוב הרוחב */
    background: #fff; /* רקע לבן, תואם לטבלאות */
}

#notes-area:focus {
    outline: none; /* הסרת מסגרת פוקוס */
    border-color: #176c4c; /* שמירה על צבע מסגרת בעת פוקוס */
    box-shadow: 0 0 3px rgba(23, 108, 76, 0.3); /* צל קל בעת פוקוס */
}

.save-notes-btn {
    display: block; /* תצוגה כבלוק */
    margin: 10px auto 0 auto; /* מיקום במרכז עם שוליים עליונים */
    padding: 8px 15px; /* ריווח פנימי */
    background: #23b6d8; /* רקע כחול, תואם לכפתורי הוספה */
    color: #fff; /* צבע טקסט לבן */
    border: none; /* ללא מסגרת */
    border-radius: 5px; /* פינות מעוגלות */
    cursor: pointer; /* סמן עכבר בצורת יד */
    font-size: 1em; /* גודל גופן רגיל */
    transition: background 0.2s; /* אנימציה לשינוי צבע */
}

.save-notes-btn:hover {
    background: #176c4c; /* שינוי צבע לירוק כהה בעת ריחוף, תואם לכפתורים אחרים */
}

/* סגנונות לקו מפריד */
hr.air {
    width: 950px; /* רוחב תואם לטבלאות */
    max-width: 98vw; /* רוחב מקסימלי למניעת גלישה */
    margin: 15px auto; /* מיקום במרכז עם שוליים עליונים ותחתונים */
    border: 0; /* הסרת גבול ברירת מחדל */
    border-top: 5px solid #ff0000; /* קו אדום, עובי ניתן לשינוי */
    height: 0; /* גובה אפס כדי להציג רק את הקו */
}
/* סגנונות להדפסה */
@media print {
    .floating-window {
        display: none !important; /* הסתרת חלון הכפתורים הצף */
    }
    .icon-btn, .trashBtn, .undoBtn, .addRowBtn, .cloneBtn {
        display: none !important; /* הסתרת כל הכפתורים בצד הטבלאות */
    }
    .save-notes-btn {
        display: none !important; /* הסתרת כפתור שמירת הערות */
    }
    hr.air, .noPrint {
        display: none !important; /* הסתרת אלמנטים נוספים שלא צריכים להופיע */
    }
    .action-col {
        display: none !important; /* הסתרת עמודת DEL (עם כפתורי מחיקה ושחזור) */
    }
    .row-dimmed {
        display: none !important; /* הסתרת שורות מחוקות (עם המחלקה row-dimmed) */
    }
    .dimmed {
        display: none !important; /* הסתרת טבלאות מחוקות (עם המחלקה dimmed) */
    }
    .box-table-wrapper.empty-table {
        display: none !important; /* הסתרת טבלאות ריקות (ללא שורות גלויות) */
    }
    /* התאמת רוחב העמודות כדי לפצות על הסרת עמודת DEL */
    .desc-col {
        width: 50% !important; /* התאמת רוחב עמודת התיאור - ניתן לשנות לפי הצורך */
    }
    .pn-col {
        width: 20% !important; /* התאמת רוחב עמודת P/N */
    }
    .qty-col {
        width: 15% !important; /* התאמת רוחב עמודת Qty */
    }
    .check-col {
        width: 15% !important; /* התאמת רוחב עמודת Check List */
    }
    /* שאר הסגנונות להדפסה כפי שהיו */
    @page {
        size: A4 portrait;
        margin: 1cm;
    }
    html, body {
        font-size: 8.5pt !important;
        line-height: 1.05 !important;
        margin: 0 !important;
        padding: 0 !important;
        background: #fff !important;
        color: #111 !important;
    }
    .main-container {
        display: flex !important;
        flex-direction: row !important;
        justify-content: space-between;
        align-items: flex-start;
        width: 100vw;
        max-width: 100vw !important;
        gap: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    .col {
        width: 49.5% !important;
        min-width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box !important;
        border-width: 1px !important;
        box-shadow: none !important;
    }
    .section-title {
        font-size: 0.92em !important;
        padding: 1px 0 !important;
        margin: 0 !important;
        border-width: 1px !important;
    }
    .custom-table, .custom-table th, .custom-table td {
        font-size: 0.82em !important;
        padding: 1px 2px !important;
        border-width: 1px !important;
    }
    input, select {
        font-size: 0.82em !important;
        padding: 1px 2px !important;
        margin: 0 !important;
        width: 98% !important;
        box-sizing: border-box !important;
        border: none !important; /* הסרת מסגרות משדות קלט */
        background: transparent !important; /* רקע שקוף לשדות קלט */
    }
    .customer-row {
        margin: 4cm 0 4px 0 !important;
        font-size: 1em !important;
        max-width: 100vw !important;
        padding: 0 !important;
    }
    h1 {
        text-align: center !important; /* מרכוז הכותרת בהדפסה */
        margin: 10px auto !important; /* מיקום במרכז */
    }
    /* הוספת סגנון לתא BOX בהדפסה */
    .box-header {
        background: #e6f2ef !important; /* רקע ירוק בהיר */
        color: #176c4c !important; /* צבע טקסט ירוק כהה */
        font-size: 0.9em !important; /* גודל גופן קטן יותר */
        text-align: center !important; /* מרכוז הטקסט */
    }
    .box-fraction {
        font-weight: bold !important; /* הדגשת המספר השבר */
        color: #0d3d2c !important; /* צבע כהה יותר למספר השבר */
    }
}


/*------------------------------- לא לגעת   סיום סגנונות כלליים לדף ----------------------------------------*/
    </style>
</head>
<body>

    <!------------------------------------- לא לגעת  חלון כפתורים צף---------------------- -->
    <div class="floating-window">
        <button title="הצג כ-PDF" onclick="window.print()">
            <img src="https://raw.githubusercontent.com/RL3printer/Matan_EFI/main/icons/pdficon.png" alt="PDF">
        </button>
        <button title="חזרה לדף הבית" onclick="window.location.href='index.html'">
            <img src="https://raw.githubusercontent.com/RL3printer/Matan_EFI/main/icons/backIcon.jpg" alt="Home">
        </button>
        <button class="add-btn" title="הוסף טבלה ריקה" onclick="addEmptyTable()">+</button>
    </div>

<!------------------------------------- לא לגעת סיום   חלון כפתורים צף---------------------- -->

<!------------------------------------- כותרת של הדף---------------------- -->
    <h1>Pro 32r - Box</h1>
<!------------------------------------- כותרת של הדף---------------------- -->
	
	
<!---------------------------- BOX 1 ---------------------------->
<div class="box-table-wrapper">
    <button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
    </button>
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">PC</td>
            <td class="pn-col">88801150</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">2</td>
            <td class="desc-col">KEY CONFIGURATION HASP R2R MATAN</td>
            <td class="pn-col">88801185</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		 <tr class="data-row">
            <td class="row-num-cell">3</td>
            <td class="desc-col">KEYBOARD</td>
            <td class="pn-col">45081288</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
			<tr class="data-row">
            <td class="row-num-cell">4</td>
            <td class="desc-col">mouse</td>
            <td class="pn-col">P4677-A</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            
        </tr>
    </table>
</div>
<!----------------------------BOX 1 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">	
 <!-------------------------- BOX 2 ------------------>
<div class="box-table-wrapper">
    
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">TOOLS BOX/KIT</td>
            <td class="pn-col">10106618</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 2 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
<!---------------------------- BOX 3 ---------------->
<div class="box-table-wrapper">
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">STRIPPER/SCRAPER WALLPAPER W=100MM WITH HANDLE AND REPLACEABLE BLADE</td>
            <td class="pn-col">10100017</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">2</td>
            <td class="desc-col">TIP CLEANER CLEANERDRILL KIT #6-#26</td>
            <td class="pn-col">10100018</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		 <tr class="data-row">
            <td class="row-num-cell">3</td>
            <td class="desc-col">SUPPORT AIR SHAFT PRO 32R</td>
            <td class="pn-col">45073520</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> <tr class="data-row">
            <td class="row-num-cell">4</td>
            <td class="desc-col">CLOTH MESH PRINTING 3700X195MM PRO 32R</td>
            <td class="pn-col">22202064</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr><tr class="data-row">
            <td class="row-num-cell">5</td>
            <td class="desc-col">RING FOR AIR SHAFT PRO 32R</td>
            <td class="pn-col">22202083</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>		 <tr class="data-row">
            <td class="row-num-cell">6</td>
            <td class="desc-col">FILTERS BAG OF 20 PU FOAM 195X55X5 FOR UV LED LAMP</td>
            <td class="pn-col">22202007</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		     <tr class="data-row">
            <td class="row-num-cell">7</td>
            <td class="desc-col">WIPERS NONWOVEN DRY 23X23CM PACK OF 300</td>
            <td class="pn-col">77700077</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> 
		<tr class="data-row">
            <td class="row-num-cell">8</td>
            <td class="desc-col">GLOVES, RUBBER</td>
            <td class="pn-col">77700180</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>      	 <tr class="data-row">
            <td class="row-num-cell">9</td>
            <td class="desc-col">GREASE FOR BEARINGS, LONGTERM</td>
            <td class="pn-col">77700199</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>    
		<tr class="data-row">
            <td class="row-num-cell">10</td>
            <td class="desc-col">SYRINGE LUER TIP 50M</td>
            <td class="pn-col">77700243</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> 	
		<tr class="data-row">
            <td class="row-num-cell">11</td>
            <td class="desc-col">HUMIDITY METER 10-50</td>
            <td class="pn-col">77700277</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr> 
				<tr class="data-row">
            <td class="row-num-cell">12</td>
            <td class="desc-col">BRUSH WITH WOOD HANDLE NYLON 20X100X350MM 3 LINES</td>
            <td class="pn-col">77700689</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr> 
				<tr class="data-row">
            <td class="row-num-cell">13</td>
            <td class="desc-col">PRESS PEDAL SWITCH WIRED</td>
            <td class="pn-col">10106633</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>		
		</table>
</div>

<!----------------------------BOX 3 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 4 ------------------>
<div class="box-table-wrapper">
    
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">VINYL</td>
            <td class="pn-col">999</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 4 END -------------> 
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
<!---------------------------- BOX 5 ---------------->
<div class="box-table-wrapper">
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">METAL CLAMP</td>
            <td class="pn-col">45087570</td>
            <td class="qty-col">40</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">2</td>
            <td class="desc-col">SYRINGE</td>
            <td class="pn-col">10106609</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		 <tr class="data-row">
            <td class="row-num-cell">3</td>
            <td class="desc-col">TUBING TYGON 2375 1/8X1/4 CLEAR</td>
            <td class="pn-col">P7170-A</td>
            <td class="qty-col">4</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> <tr class="data-row">
            <td class="row-num-cell">4</td>
            <td class="desc-col">FITTING, MALE, EXTERNAL THREAD</td>
            <td class="pn-col">10106104</td>
            <td class="qty-col">12</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr><tr class="data-row">
            <td class="row-num-cell">5</td>
            <td class="desc-col">FITTING 4MM INTERNAL THREAD MTLL025-2</td>
            <td class="pn-col">10106333</td>
            <td class="qty-col">24</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>		 <tr class="data-row">
            <td class="row-num-cell">6</td>
            <td class="desc-col">TUBING 6.4MM OD X 3.2MM ID BLK</td>
            <td class="pn-col">45165796</td>
            <td class="qty-col">6</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		     <tr class="data-row">
            <td class="row-num-cell">7</td>
            <td class="desc-col">PLUG,LUER,BLACK,THREADED ,3</td>
            <td class="pn-col">45087592</td>
            <td class="qty-col">24</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> 
		<tr class="data-row">
            <td class="row-num-cell">8</td>
            <td class="desc-col">ANTI-STATIC WATCH</td>
            <td class="pn-col">10106610</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>      	 <tr class="data-row">
            <td class="row-num-cell">9</td>
            <td class="desc-col">BOTTLE -CLEAN BOTTLE</td>
            <td class="pn-col">45184720</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>    
		<tr class="data-row">
            <td class="row-num-cell">10</td>
            <td class="desc-col">WRENCH, SPANNER,FOR PURGE VALVES</td>
            <td class="pn-col">45117492</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr> 	
		<tr class="data-row">
            <td class="row-num-cell">11</td>
            <td class="desc-col">HEIGHT MEASURE</td>
            <td class="pn-col">10106612</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr> 
				<tr class="data-row">
            <td class="row-num-cell">12</td>
            <td class="desc-col">PLAIN WASHERS</td>
            <td class="pn-col">10106613</td>
            <td class="qty-col">24</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr>
  				  </tr> 
				<tr class="data-row">
            <td class="row-num-cell">13</td>
            <td class="desc-col">Socket Head Screw</td>
            <td class="pn-col">10106614</td>
            <td class="qty-col">24</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr>
				 <tr class="data-row">
            <td class="row-num-cell">13</td>
            <td class="desc-col">SCREW SET M4X10 W BALL PLUNGER</td>
            <td class="pn-col">45165658</td>
            <td class="qty-col">4</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr> 
				<tr class="data-row">
            <td class="row-num-cell">13</td>
            <td class="desc-col">Adjusting assy for G5 printhead</td>
            <td class="pn-col">10106430</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
                </tr>
				<tr class="data-row">
            <td class="row-num-cell">13</td>
            <td class="desc-col">AIR TUBE</td>
            <td class="pn-col">10106617</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
			<td class="action-col">
            </td>
        </tr>		
		<tr class="data-row">
            <td class="row-num-cell">14</td>
            <td class="desc-col">AIR GUN</td>
            <td class="pn-col">10106616</td>
            <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
             <td class="action-col">
            </td>	
   		</tr>	
		<tr class="data-row">
            <td class="row-num-cell">14</td>
            <td class="desc-col">PRINT HEAD SLOT'S ALUMINUM COVER AL 6061</td>
            <td class="pn-col">10106615</td>
            <td class="qty-col">4</td>
            <td class="check-col"><input type="checkbox"></td>
             <td class="action-col">
			    <button class="del-row-btn" onclick="hideRow(this)">✖</button>
                <button class="undo-row-btn" onclick="restoreRow(this)">↩</button>
            </td>
            </td>	
   		</tr>
		 <tr class="data-row">
            <td class="row-num-cell">15</td>
            <td class="desc-col">KIT SHIMS FOR ENCODER ALIGNMENT</td>
            <td class="pn-col">10106636</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
             <td class="action-col">
            </td>	
   		</tr>
    </table>
</div>

<!----------------------------BOX 5 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 6 ------------------>
<div class="box-table-wrapper">
    
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">WORK STATION</td>
            <td class="pn-col">999</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 6 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 7 ------------------>
<div class="box-table-wrapper">
    
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">TEST FILE</td>
            <td class="pn-col">999</td>
            <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 7 END -------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">

 <!-------------------------- BOX 8 ------------------>
<div class="box-table-wrapper">
   
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">Slitter for Pro 32r+</td>
            <td class="pn-col">10102049</td>
             <td class="qty-col">			
           <select>
               <option>1</option>
               <option>2</option>
			   <option>3</option>
			   <option>4</option>
               <option>5</option>
			   <option>6</option>
               <option>7</option>
			   <option>8</option>
			   <option>9</option>
			   <option>10</option>
	    	   <option>11</option>
			   <option>12</option>
           </select>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 8 END -------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 9 ------------------>
<div class="box-table-wrapper">
    
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">media Edge guard</td>
            <td class="pn-col">10102074</td>
            <td class="qty-col">			
           <select>
               <option>1</option>
               <option>2</option>
			   <option>3</option>
			   <option>4</option>
               <option>5</option>
			   <option>6</option>
               <option>7</option>
			   <option>8</option>
			   <option>9</option>
			   <option>10</option>
	    	   <option>11</option>
			   <option>12</option>
           </select>            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 9 END -------------> 
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 10 ------------------>
<div class="box-table-wrapper" data-group-id="ink-cyan">
    <button class="icon-btn trashBtn" title="הסר טבלה" onclick="dimTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">
    </button>
    <button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
    </button>
    <!-- כפתור חדש לשכפול הטבלה -->
    <button class="icon-btn cloneBtn" title="שכפל טבלה" onclick="cloneTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/2983/2983067.png" alt="Clone">
    </button>
    <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">SHAFT LOAD-UNLOAD EXPANDING 1.6M CORE 3" PNEUMATIC</td>
            <td class="pn-col">77700795</td>
            <td class="qty-col"><input type="text" value="1/1"></td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 10 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
 <!-------------------------- BOX 11 ------------------>
<div class="box-table-wrapper" data-group-id="ink-cyan">
    <button class="icon-btn trashBtn" title="הסר טבלה" onclick="dimTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">
    </button>
    <button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
    </button>
         <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">DUAL AIR SHAFT CENTER SUPPORT ASSY</td>
            <td class="pn-col">11101908</td>
            <td class="qty-col"><select>
               <option>1</option>
               <option>2</option>
			             </select>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		<tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">	ASSY LIMITER SHAFT FOR DUAL SHAFT PRO 32</td>
            <td class="pn-col">11101937</td>
            <td class="qty-col"><select>
               <option>4</option>
               <option>8</option>
			  </select>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 11 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air"> 
<!-------------------------- BOX 12 ------------------>
<div class="box-table-wrapper" data-group-id="ink-cyan">
    <button class="icon-btn trashBtn" title="הסר טבלה" onclick="dimTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">
    </button>
    <button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
    </button>
      <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">ASSY AUTOMATIC BACKLIT ASSY</td>
            <td class="pn-col">11101963</td>
              <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		<tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">CABLE CAT 7 1M RJ45 X2 BLUE</td>
            <td class="pn-col">88801023</td>
             <td class="qty-col">2</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
    </table>
</div>
<!----------------------------BOX 12 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
	<!-------------------------- BOX 13 ------------------>
<div class="box-table-wrapper" data-group-id="ink-cyan">
    <button class="icon-btn trashBtn" title="הסר טבלה" onclick="dimTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">
    </button>
    <button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
    </button>
      <table class="box-table">
        <tr>
            <th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
            <th>DESCRIPTION</th>
            <th>P/N</th>
            <th>Qty</th>
            <th>CHECK LIST</th>
            <th class="action-col">Del</th>
        </tr>
        <tr class="data-row">
            <td class="row-num-cell">1</td>
            <td class="desc-col">ON SITE SPARE PARTS KIT FOR PRO 32R</td>
            <td class="pn-col">10102052</td>
              <td class="qty-col">1</td>
            <td class="check-col"><input type="checkbox"></td>
            <td class="action-col">
            </td>
        </tr>
		    </table>
</div>
<!----------------------------BOX 13 END ---------------------------->
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
<!---------------------- אזור הערות בסוף הדף, מתחת לכל הטבלאות ---------------------->
<div class="notes-section">
    <h2>comments</h2>
    <textarea id="notes-area" placeholder="..." rows="5"></textarea>
    
</div>
<!---------------------- אזור הערות בסוף הדף, מתחת לכל הטבלאות ---------------------->

    <script>

 <!----------------------JavaScript  ----------------------> 
// פונקציה שמחזירה את כל ה־box-table-wrapper שבאותה קבוצה (בין <hr class="noPrint air">)
function getGroupTables(wrapper) {
  const allElements = Array.from(document.querySelectorAll('.box-table-wrapper, hr.noPrint.air'));
  const idx = allElements.indexOf(wrapper);
  if (idx === -1) return [];
  // חפש אחורה עד ל-<hr> או לתחילת הדף
  let start = idx;
  while (start > 0 && !allElements[start - 1].matches('hr.noPrint.air')) {
    start--;
  }
  // חפש קדימה עד ל-<hr> הבא או לסוף הדף
  let end = idx;
  while (end < allElements.length - 1 && !allElements[end + 1].matches('hr.noPrint.air')) {
    end++;
  }
  // תחום הקבוצה: כל box-table-wrapper מ-start עד end (כולל)
  return allElements.slice(start, end + 1).filter(el => el.classList && el.classList.contains('box-table-wrapper'));
}

// עדכון מספור BOX רק לטבלאות גלויות
function updateBoxNumbers() {
  const visibleWrappers = Array.from(document.querySelectorAll('.box-table-wrapper:not(.dimmed)'));
  visibleWrappers.forEach((wrapper, index) => {
    const currentSpan = wrapper.querySelector('.box-current');
    const totalSpan = wrapper.querySelector('.box-total');
    if (currentSpan) currentSpan.textContent = index + 1;
    if (totalSpan) totalSpan.textContent = visibleWrappers.length;
  });
}

// עדכון מספרי שורה בטבלה
function updateRowNumbers(table) {
  const rows = table.querySelectorAll('tr.data-row:not(.row-dimmed)');
  rows.forEach((row, index) => {
    const rowNumCell = row.querySelector('.row-num-cell');
    if (rowNumCell) {
      rowNumCell.textContent = index + 1;
    }
  });
}

// הפעלת העדכון עבור כל הטבלאות בדף
function updateAllRowNumbers() {
  const tables = document.querySelectorAll('.box-table');
  tables.forEach(table => updateRowNumbers(table));
}

// הוספת טבלה חדשה לפני אזור ההערות
function addEmptyTable() {
  const wrapper = document.createElement('div');
  wrapper.className = 'box-table-wrapper';
  wrapper.innerHTML = `
<button class="icon-btn trashBtn" title="הסר טבלה" onclick="dimTable(this)">
<img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">
</button>
<button class="icon-btn undoBtn" title="החזר טבלה" style="display:none;" onclick="restoreTable(this)">
<img src="https://cdn-icons-png.flaticon.com/512/109/109618.png" alt="Undo">
</button>
<button class="icon-btn addRowBtn" title="הוסף שורה" onclick="addRowToTable(this)">
<img src="https://cdn-icons-png.flaticon.com/512/992/992651.png" alt="Add Row">
</button>
 <button class="icon-btn cloneBtn" title="שכפל טבלה" onclick="cloneTable(this)">
        <img src="https://cdn-icons-png.flaticon.com/512/2983/2983067.png" alt="Clone">
 </button>
<table class="box-table">
<tr>
<th class="box-header">BOX<br><span class="box-current"></span>/<span class="box-total"></span></th>
<th>DESCRIPTION</th>
<th>P/N</th>
<th>Qty</th>
<th>CHECK LIST</th>
<th class="action-col">Del</th>
</tr>
<tr class="data-row">
<td class="row-num-cell"></td>
<td class="desc-col"><input type="text" placeholder=""></td>
<td class="pn-col"><input type="text" placeholder=""></td>
<td class="qty-col"><input type="text" placeholder=""></td>
<td class="check-col"><input type="checkbox"></td>
<td class="action-col">
<button class="del-row-btn" onclick="hideRow(this)">✖</button>
<button class="undo-row-btn" onclick="restoreRow(this)">↩</button>
</td>
</tr>
</table>
<!-- קו מפריד בין טבלאות, לא יופיע בהדפסה -->
<hr class="noPrint air">
  `;
  // הוספת הטבלה החדשה לפני אזור ההערות
const notesSection = document.querySelector('.notes-section');
  if (notesSection) {
    document.body.insertBefore(wrapper, notesSection);
  } else {
    document.body.appendChild(wrapper);
  }
  updateBoxNumbers();
  updateAllRowNumbers();
  updateQtyValues();
}

// הוספת שורה חדשה לטבלה
function addRowToTable(btn) {
  const wrapper = btn.closest('.box-table-wrapper');
  const table = wrapper.querySelector('.box-table');
  const newRow = document.createElement('tr');
  newRow.className = 'data-row';
  newRow.innerHTML = `
<td class="row-num-cell"></td>
<td class="desc-col"><input type="text" placeholder=""></td>
<td class="pn-col"><input type="text" placeholder=""></td>
<td class="qty-col"><input type="text" placeholder=""></td>
<td class="check-col"><input type="checkbox"></td>
<td class="action-col">
<button class="del-row-btn" onclick="hideRow(this)">✖</button>
<button class="undo-row-btn" onclick="restoreRow(this)">↩</button>
</td>
  `;
  table.appendChild(newRow);
  updateRowNumbers(table);
}

// הסתרת שורה
function hideRow(btn) {
  const tr = btn.closest('tr');
  tr.classList.add('row-dimmed');
  tr.querySelector('.del-row-btn').style.display = 'none';
  tr.querySelector('.undo-row-btn').style.display = 'inline';
  updateRowNumbers(tr.closest('.box-table'));
}

// שחזור שורה
function restoreRow(btn) {
  const tr = btn.closest('tr');
  tr.classList.remove('row-dimmed');
  tr.querySelector('.del-row-btn').style.display = 'inline';
  tr.querySelector('.undo-row-btn').style.display = 'none';
  updateRowNumbers(tr.closest('.box-table'));
}

// הסתרת טבלה (עמעום בלבד)
function dimTable(btn) {
  const wrapper = btn.closest('.box-table-wrapper');
  wrapper.classList.add('dimmed');
  wrapper.querySelector('.trashBtn').style.display = 'none';
  wrapper.querySelector('.undoBtn').style.display = 'block';
  updateBoxNumbers();
  updateQtyValues(wrapper);
}

// שחזור טבלה מעומעמת
function restoreTable(btn) {
  const wrapper = btn.closest('.box-table-wrapper');
  wrapper.classList.remove('dimmed');
  wrapper.querySelector('.trashBtn').style.display = 'block';
  wrapper.querySelector('.undoBtn').style.display = 'none';
  updateBoxNumbers();
  updateQtyValues(wrapper);
}

// פונקציה לשכפול טבלה
function cloneTable(btn) {
  const wrapper = btn.closest('.box-table-wrapper');
  const clonedWrapper = wrapper.cloneNode(true);
  clonedWrapper.classList.remove('dimmed');
  clonedWrapper.querySelector('.trashBtn').style.display = 'block';
  clonedWrapper.querySelector('.undoBtn').style.display = 'none';
  wrapper.parentNode.insertBefore(clonedWrapper, wrapper.nextSibling);
  updateBoxNumbers();
  updateAllRowNumbers();
  updateQtyValues(clonedWrapper);
}

// עדכון ערכי ה־Qty עבור קבוצה + אשכולות עם אותו Description
function updateQtyValues(wrapper) {
  // תחילה מביאים את כל הקבוצה
  const groupWrappers = getGroupTables(wrapper).filter(w => !w.classList.contains('dimmed'));
  // מחלקים לאשכולות לפי ערך DESCRIPTION (input/text או span)
  const clusters = {};
  groupWrappers.forEach(wrap => {
    let desc = '';
    // חיפוש הערך של התיאור: תא ראשון מסוג input, אם קיים, אחרת טקסט ישיר
    const descCell = wrap.querySelector('.desc-col input') 
      ? wrap.querySelector('.desc-col input') 
      : wrap.querySelector('.desc-col');
    if (descCell) {
      desc = descCell.value !== undefined ? descCell.value : descCell.textContent.trim();
    }
    // להגדיר מפתח ריק תמיד כ"ריק"
    if (!desc) desc = 'ריק';
    if (!clusters[desc]) clusters[desc] = [];
    clusters[desc].push(wrap);
  });
  // לכל אשכול (עם אותו Description), עדכן Qty בסדרה משלו
  Object.values(clusters).forEach(wrappersArr => {
    const totalVisible = wrappersArr.length;
    wrappersArr.forEach((w, idx) => {
      const qtyInputs = w.querySelectorAll('.qty-col input[type="text"]');
      qtyInputs.forEach(input => {
        input.value = `${idx + 1}/${totalVisible}`;
      });
    });
  });
}

// שמירת הערות (פונקציה בסיסית, ניתן להרחיב)
function saveNotes() {
  const notes = document.getElementById('notes-area').value;
  localStorage.setItem('notes', notes);
  alert('ההערות נשמרו בהצלחה!');
}

// טעינת הערות משמירה קודמת בעת טעינת הדף
window.onload = function() {
  const savedNotes = localStorage.getItem('notes');
  if (savedNotes) {
    document.getElementById('notes-area').value = savedNotes;
  }
  updateBoxNumbers();
  updateAllRowNumbers();
  // עדכון כל קבוצה בנפרד (וגם לכל אשכול Description בקבוצה)
  document.querySelectorAll('.box-table-wrapper').forEach(wrapper => {
    updateQtyValues(wrapper);
  });
  
  window.addEventListener("beforeunload", function (e) {
  var confirmationMessage = "האם אתה בטוח שברצונך לאפס את כל המידע בדף?";
  (e || window.event).returnValue = confirmationMessage; // עבור דפדפנים ישנים
  return confirmationMessage; // עבור דפדפנים חדשים
});

}






    </script>

</body>
</html>
